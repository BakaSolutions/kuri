<article class="post" data-number="{{!post.number}}" data-board="{{!it.board.name}}" data-op="{{! post.number == post.threadNumber}}">
	<div class="postDetails">
		<!-- Удаление поста -->
		<input type="checkbox" id="delete-{{!it.board.name}}:{{!post.number}}" name="post" value="{{!it.board.name}}:{{!post.number}}" form="deletePosts" hidden>
		<label for="delete-{{!it.board.name}}:{{!post.number}}" class="material-icons jsOnly" onclick="activatePostRemovalWidget()">delete</label>

		<!-- Сажа -->
		{{? post.sage}}
			<span class="material-icons">details</span>
		{{? }}

		<!-- Рефлинк -->
		<a class="refLink" href="{{=it.site.url.pathname}}{{!it.board.name}}/res/{{!post.threadNumber}}.html{{? post.number != post.threadNumber}}#{{!post.number}}">{{?? }}">{{? }}
			<span class="subject">{{? post.subject}}{{!post.subject}}{{?? }}{{!it.board.defaultUsername || ''}}{{? }}</span> #{{!post.number}}
		</a>

		<a class="jumpToPost" name="{{!post.number}}"></a>

		<!-- Дата -->
		<time title="{{!post.createdAt}}">{{!post.formatted_date}}</time>

		<!-- Меню -->
		<span class="material-icons jsOnly" onclick="openPostMenu(event, '{{!it.board.name}}', {{!post.number}}{{? post.number == post.threadNumber}}, 1{{? }})">menu</span>

		<!-- Быстрый ответ -->
		<span class="material-icons jsOnly" onclick="quickReply({{!post.number}}, {{!post.threadNumber}})">reply</span>

		<!-- Закладки -->
		{{? post.number == post.threadNumber}}
			<input type="checkbox" id="star-{{!it.board.name}}:{{!post.number}}" hidden>
			<label for="star-{{!it.board.name}}:{{!post.number}}" class="material-icons jsOnly" onclick="addToFavourites('{{!it.board.name}}:{{!post.number}}')">star</label>
		{{? }}
	</div>
	<div class="postBody">
		{{? Array.isArray(post.files) && post.files.length}}
			<div class="postAttachments">
				{{~post.files :file}}
					{{? ["image", "video"].includes(file.mime.split("/")[0])}}
						<div class="thumb">
							{{? file.thumb.path }}<img src="{{=it.foxtan.thumb}}{{!file.thumb.path}}" width="{{!file.thumb.width}}" height="{{!file.thumb.height}}">{{?? }}<div class="noPreview"></div>{{? }}

							<a class="info" href="{{=it.foxtan.upload}}{{!file.path}}" target="_blank" onclick="media.prepare(event, '{{=file.mime}}', '{{!file.name}}')">
								<span>{{!file.mime}} file</span>
								<span>{{? file.size < 1048576}}{{! (file.size / 1024).toFixed(1)}} KiB{{?? }}{{! (file.size / 1048576).toFixed(1)}} MiB{{? }}</span>
							</a>

							<a class="dlLink" href="{{=it.foxtan.upload}}{{!file.path}}" download="{{!file.name}}">сохранить</a>
						</div>
					{{?? }}
						<a class="unpreviewable" href="{{=it.foxtan.upload}}{{!file.path}}" download="{{!file.path}}"{{? file.mime.split("/")[0] == "audio" }}onclick="loadAudio(event, '{{=it.foxtan.upload}}{{!file.path}}', '{{!file.name}}')"{{? }}>{{!file.name}} <div>({{! (file.size / 1048576).toFixed(2) }} Mb)</div></a>
					{{? }}
				{{~ }}
			</div>
		{{? }}
		<div class="postText">
			{{=post.text}}

			{{? post.replies }}
				<div class="postReplies">Ответы: {{!post.replies}}</div>
			{{? }}
		</div>
	</div>
</article>
